{% extends "layout.html" %}


{% block title %}{{lj.title}}{% endblock %}
{% block head %}
    {{ super() }}
{% endblock %}
{% block masthead %}
    <h1 class="title">{{lj.title}}</h1>
    <p>{{lj.summary}}</p>
    <p>{{lj.database}}</p>
{% endblock %}

{% block body %}

<div >

    <div class = "row">
        <div class="col-md-6">

            {% if lj.manifests-%}
            <div>
                <h2>Collections</h2>
                <p>Collections of data bundles around a specific topic.</p>
                <table  class="table table-hover table-condensed" >
                {% for uid, m in lj.manifests.items() -%}
                    <tr>
                    <td><a href="{{manifest_path(uid)}}">{{m.title}}</a></td>
                    <td>{{m.summary}}</td>
                    </tr>
                {% endfor %}
                </table>
            </div>
            {% endif -%}

        </div>
        <div class="col-md-6">
            {% if lj.stores -%}
            <div>
                <h2>Databases</h2>
                <p>Databases that use data from this library. </p>
                <table  class="table table-hover table-condensed" >
                {% for ref,s in lj.stores.items() -%}
                    <tr>
                    <td><a href="store_path(ref)">{{s.title}}</a></td>
                    <td>{{s.summary}}</td>
                    </tr>
                {% endfor %}
                </table>
            </div>
        {% endif %}
        </div>
    </div>
    <div class="clearfix">
        <h2>Bundles</h2>
        <table class="table table-hover  table-condensed" >
            <tr>
                <th>#</th>
                <th>VID</th>
                <th>Source</th>
                <th>Dataset</th>
                <th>Name</th>
                <th>Versions</th>
                <th>Title</th>
            </tr>
            {% for b in bundle_sort(lj.bundles.values(), 'name') -%}
                <tr class="bundle_toc">
                    <td>{{loop.index}}</td>
                    <td class="toc_vid"><a href="{{bundle_path(b)}}">{{b.identity.vid}}</a></td>
                    <td class="toc_source">{{b.identity.source}}</td>
                    <td class="toc_dataset">{{b.identity.dataset}}</td>
                    <td class="toc_name">{{b.identity.name}}</td>
                    <td class="toc_version">
                        <ul  class="list-inline">
                            <li><a href="{{bundle_path(b.identity.vid)}}">{{b.identity.version}}</a></li>
                            {% if b.other_versions -%}
                            {% for v in b.other_versions|sort(attribute='revision',reverse=True) -%}
                            <li><a href="{{bundle_path(v.vid)}}">{{v.version}}</a></li>
                            {% endfor %}
                            {% endif -%}
                        </ul>
                    </td>

                    <td class="toc_title" data-toggle="tooltip" data-placement="left"
                        title="{{(b.about.summary or '')|truncate(length=600)}}">
                        {{b.about.title or ''}}</td>
                    </td>
                </tr>
            {% endfor %}
        </table>
    </div>


</div>


{% endblock %}

{% block tailjs %}
    {{ super() }}
    <script>
    $('.toc_title').tooltip()
    </script>
{% endblock %}